<%
  const labelMap = {
    best: "Melhor jogador",
    scorer: "Artilheiro",
    assist: "Assistente",
    photos: "Rei das fotos",
    goalie: "Melhor goleiro",
    defender: "Melhor zagueiro",
    midfielder: "Melhor meia",
    forward: "Melhor atacante",
  };

  const featured = hallFeatured || {};

  const catLabel = {
    MELHOR_JOGADOR: "Melhor jogador",
    ARTILHEIRO: "Artilheiro",
    ASSISTENTE: "Assistente",
    REI_DAS_FOTOS: "Rei das fotos",
    MELHOR_GOLEIRO: "Melhor goleiro",
    MELHOR_ZAGUEIRO: "Melhor zagueiro",
    MELHOR_MEIA: "Melhor meia",
    MELHOR_ATACANTE: "Melhor atacante",
  };

  const statValue = (award) => {
    if (!award || !award.player) return null;
    const p = award.player;
    const cat = (award.category || "").toLowerCase();
    switch (cat) {
      case "artilheiro":
        return p.totalGoals || 0;
      case "assistente":
        return p.totalAssists || 0;
      case "rei_das_fotos":
        return p.totalPhotos || 0;
      default:
        return null;
    }
  };
%>

<section class="max-w-6xl mx-auto space-y-10 animate-fadeIn">
  <header class="text-center space-y-2">
    <p class="text-sm text-horriver-gray">Imortais da Horriver Plate</p>
    <h1 class="text-3xl md:text-4xl font-title text-horriver-light">Hall da Fama</h1>
  </header>

  <% if (featured.best && featured.best.player) { 
       const hero = featured.best.player;
    %>
    <div class="relative overflow-hidden rounded-3xl border border-horriver-orange/40 bg-gradient-to-br from-black/80 via-black/60 to-horriver-red/20 shadow-card-soft">
      <div class="absolute inset-0 pointer-events-none">
        <div class="absolute -top-32 -left-16 w-72 h-72 bg-horriver-orange/20 blur-3xl rounded-full"></div>
        <div class="absolute -bottom-40 right-0 w-80 h-80 bg-horriver-red/25 blur-3xl rounded-full"></div>
      </div>
      <div class="relative grid md:grid-cols-2 gap-6 p-6 md:p-8 items-center">
        <div class="space-y-3">
          <p class="text-xs text-horriver-orange uppercase tracking-[0.2em]">Melhor jogador</p>
          <h2 class="text-3xl md:text-4xl text-horriver-light font-semibold"><%= hero.name %></h2>
          <% if (hero.nickname) { %>
            <p class="text-horriver-gray text-sm">(<%= hero.nickname %>)</p>
          <% } %>
          <p class="text-[11px] text-horriver-gray/80">Temporada <%= latestSeasonYear %></p>

          <div class="grid grid-cols-2 gap-3 text-sm">
            <div class="bg-black/40 border border-horriver-border/60 rounded-xl px-3 py-2">
              <p class="text-horriver-gray text-[11px]">Posi��o</p>
              <p class="text-horriver-orange font-semibold"><%= hero.position %></p>
            </div>
            <div class="bg-black/40 border border-horriver-border/60 rounded-xl px-3 py-2">
              <p class="text-horriver-gray text-[11px]">M�dia</p>
              <p class="text-horriver-light font-semibold"><%= (hero.totalRating || 0).toFixed(2) %></p>
            </div>
            <div class="bg-black/40 border border-horriver-border/60 rounded-xl px-3 py-2">
              <p class="text-horriver-gray text-[11px]">Gols</p>
              <p class="text-horriver-light font-semibold"><%= hero.totalGoals || 0 %></p>
            </div>
            <div class="bg-black/40 border border-horriver-border/60 rounded-xl px-3 py-2">
              <p class="text-horriver-gray text-[11px]">Assist.</p>
              <p class="text-horriver-light font-semibold"><%= hero.totalAssists || 0 %></p>
            </div>
          </div>
        </div>
        <div class="relative">
          <div class="absolute -inset-4 bg-horriver-orange/15 blur-3xl rounded-full"></div>
          <div class="relative w-full h-64 md:h-80 overflow-hidden rounded-2xl border-2 border-horriver-orange shadow-card-soft bg-black/60">
            <% if (hero.photoUrl) { %>
              <img
                src="<%= thumbUrl(hero.photoUrl, 480) %>"
                srcset="<%= thumbUrl(hero.photoUrl, 480) %> 1x, <%= thumbUrl(hero.photoUrl, 960) %> 2x"
                sizes="240px"
                class="w-full h-full object-cover object-top"
              />
            <% } else { %>
              <div class="w-full h-full bg-black/50"></div>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  <% } %>

  <div class="grid md:grid-cols-3 gap-4">
    <% [["scorer","Artilheiro"], ["assist","Assistente"], ["photos","Rei das fotos"]].forEach(([key,label]) => { 
         const award = featured[key];
         const val = statValue(award);
    %>
      <div class="card-inner rounded-3xl p-5 border border-horriver-border/60 bg-black/50 shadow-card-soft">
        <p class="text-xs text-horriver-orange uppercase tracking-[0.2em]"><%= label %></p>
        <% if (award && award.player) { %>
          <div class="mt-3 flex items-center gap-3">
            <div class="w-14 h-14 rounded-xl overflow-hidden border border-horriver-orange/70">
              <% if (award.player.photoUrl) { %>
                <img
                  src="<%= thumbUrl(award.player.photoUrl, 240) %>"
                  srcset="<%= thumbUrl(award.player.photoUrl, 240) %> 1x, <%= thumbUrl(award.player.photoUrl, 480) %> 2x"
                  sizes="120px"
                  class="w-full h-full object-cover"
                />
              <% } else { %>
                <div class="w-full h-full bg-black/40"></div>
              <% } %>
            </div>
            <div class="flex-1">
              <p class="text-sm text-horriver-light font-semibold"><%= award.player.name %></p>
              <% if (award.player.nickname) { %>
                <p class="text-[11px] text-horriver-gray">(<%= award.player.nickname %>)</p>
              <% } %>
              <% if (val !== null) { %>
                <p class="text-[11px] text-horriver-orange mt-1">
                  <%= label === "Artilheiro" ? "Gols" : label === "Assistente" ? "Assist�ncias" : "Fotos" %>: <%= val %>
                </p>
              <% } %>
            </div>
          </div>
        <% } else { %>
          <p class="text-sm text-horriver-gray mt-2">N�o definido na temporada.</p>
        <% } %>
      </div>
    <% }) %>
  </div>

  <div class="grid md:grid-cols-2 gap-4">
    <% [["goalie","Melhor goleiro"], ["defender","Melhor zagueiro"], ["midfielder","Melhor meia"], ["forward","Melhor atacante"]].forEach(([key,label]) => { 
         const award = featured[key];
    %>
      <div class="card-inner rounded-3xl p-5 border border-horriver-border/60 bg-black/40 shadow-card-soft flex items-center gap-4">
        <div class="w-16 h-16 rounded-xl overflow-hidden border border-horriver-orange/60">
          <% if (award && award.player && award.player.photoUrl) { %>
            <img
              src="<%= thumbUrl(award.player.photoUrl, 280) %>"
              srcset="<%= thumbUrl(award.player.photoUrl, 280) %> 1x, <%= thumbUrl(award.player.photoUrl, 560) %> 2x"
              sizes="140px"
              class="w-full h-full object-cover"
            />
          <% } else { %>
            <div class="w-full h-full bg-black/40"></div>
          <% } %>
        </div>
        <div class="flex-1">
          <p class="text-xs text-horriver-orange uppercase tracking-[0.2em]"><%= label %></p>
          <% if (award && award.player) { %>
            <p class="text-sm text-horriver-light font-semibold"><%= award.player.name %></p>
            <% if (award.player.nickname) { %>
              <p class="text-[11px] text-horriver-gray">(<%= award.player.nickname %>)</p>
            <% } %>
          <% } else { %>
            <p class="text-sm text-horriver-gray">N�o definido.</p>
          <% } %>
        </div>
      </div>
    <% }) %>
  </div>

  <section class="space-y-3">
    <div class="flex items-center justify-between">
      <h2 class="text-xl md:text-2xl font-title text-horriver-light">Hist�rico de temporadas</h2>
      <p class="text-xs text-horriver-gray">Pr�mios oficiais de anos anteriores.</p>
    </div>
    <% if (!seasonHistory || !seasonHistory.length) { %>
      <p class="text-sm text-horriver-gray">Nenhum hist�rico dispon�vel.</p>
    <% } else { %>
      <div class="space-y-4">
        <% seasonHistory.forEach(({ year, awards }) => { %>
          <div class="rounded-2xl border border-horriver-border/60 bg-black/40 shadow-card-soft">
            <div class="flex items-center justify-between px-4 py-3 border-b border-horriver-border/40">
              <h3 class="text-lg text-horriver-light font-semibold">Temporada <%= year %></h3>
            </div>
            <div class="grid sm:grid-cols-2 md:grid-cols-3 gap-4 p-4">
              <% awards.forEach((a) => { %>
                <div class="rounded-xl border border-horriver-border/50 bg-black/30 p-3 space-y-2">
                  <p class="text-[11px] uppercase tracking-[0.2em] text-horriver-orange">
                    <%= catLabel[a.category] || a.category %>
                  </p>
                  <% if (a.player) { %>
                    <p class="text-sm text-horriver-light font-semibold"><%= a.player.name %></p>
                    <% if (a.player.nickname) { %>
                      <p class="text-[11px] text-horriver-gray">(<%= a.player.nickname %>)</p>
                    <% } %>
                    <p class="text-[11px] text-horriver-gray uppercase"><%= a.player.position %></p>
                  <% } else { %>
                    <p class="text-sm text-horriver-gray">Sem jogador definido.</p>
                  <% } %>
                </div>
              <% }); %>
            </div>
          </div>
        <% }); %>
      </div>
    <% } %>
  </section>

  <section class="space-y-3">
    <div class="flex items-center justify-between">
      <h2 class="text-xl md:text-2xl font-title text-horriver-light">Aposentados</h2>
      <p class="text-xs text-horriver-gray">Jogadores que deixaram a pelada (stats continuam salvos).</p>
    </div>
    <% if (!retiredPlayers || !retiredPlayers.length) { %>
      <p class="text-sm text-horriver-gray">Nenhum aposentado registrado.</p>
    <% } else { %>
      <div class="grid sm:grid-cols-2 md:grid-cols-3 gap-4">
        <% retiredPlayers.forEach(p => { %>
          <div class="card-inner rounded-3xl p-4 border border-horriver-border/60 bg-black/40 shadow-card-soft flex gap-3">
            <div class="w-16 h-16 rounded-xl overflow-hidden border border-horriver-orange/50 bg-black/50">
              <% if (p.photoUrl) { %>
                <img
                  src="<%= thumbUrl(p.photoUrl, 200) %>"
                  srcset="<%= thumbUrl(p.photoUrl, 200) %> 1x, <%= thumbUrl(p.photoUrl, 400) %> 2x"
                  sizes="100px"
                  class="w-full h-full object-cover"
                />
              <% } else { %>
                <div class="w-full h-full flex items-center justify-center text-horriver-gray text-xs">Sem foto</div>
              <% } %>
            </div>
            <div class="flex-1 space-y-1">
              <p class="text-sm text-horriver-light font-semibold"><%= p.name %></p>
              <% if (p.nickname) { %>
                <p class="text-[11px] text-horriver-gray">(<%= p.nickname %>)</p>
              <% } %>
              <p class="text-[11px] text-horriver-orange uppercase"><%= p.position %></p>
              <span class="inline-block text-[11px] text-horriver-gray">Aposentado</span>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>
  </section>

  <!-- Listagem de Hall da Fama removida conforme solicitado -->
</section>
